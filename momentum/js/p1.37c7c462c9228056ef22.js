(()=>{"use strict";function e(e){if(localStorage.getItem(e))return localStorage.getItem(e)}function t(e,t){localStorage.setItem(e,t)}const n=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),i=document.querySelector(".time"),o=document.querySelector(".date"),c=document.querySelector(".greeting"),s=(document.querySelector(".greeting-container"),document.querySelector(".name")),a={en:{morning:"Good morning,",afternoon:"Good afternoon,",evening:"Good evening,",night:"Good night,"},ru:{morning:"Доброе утро,",afternoon:"Добрый день,",evening:"Добрый вечер,",night:"Доброй ночи,"}};function r(t){t=e("lang");const n=new Date;i.textContent=n.toLocaleTimeString(),l(t),u(t),setTimeout(r,1e3)}function l(e){const t=new Date,n={weekday:"long",month:"long",day:"numeric",timeZone:"UTC"};o.textContent="en"===e?t.toLocaleDateString("en-US",n):t.toLocaleDateString("ru-RU",n)}function d(){const e=(new Date).getHours();let t;return t=e>=6&&e<12?"morning":e>=12&&e<18?"afternoon":e>=18&&e<24?"evening":"night",t}function u(e){const t=d();c.textContent=`${a[e][t]}`}function y(e){s.placeholder="en"===e?"Enter name":"Введите имя"}window.addEventListener("load",(()=>{let t=e("name");void 0!==t&&(s.value=t)})),window.addEventListener("beforeunload",(()=>{t("name",s.value)}));const m=document.querySelector(".change-quote"),h=document.querySelector(".quote"),g=document.querySelector(".author");let v;async function p(e,t){const i=await fetch("assets/data.json"),o=await i.json();void 0===t&&(t=n(0,51)),h.textContent=o[t][e].text,g.textContent=o[t][e].author,v=t}m.addEventListener("click",(()=>{p(e("lang"))}));const w=document.querySelector(".weather-icon"),f=document.querySelector(".temperature"),k=document.querySelector(".weather-description"),b=document.querySelector(".weather-error"),S=document.querySelector(".wind"),q=document.querySelector(".humidity"),L=document.querySelector(".city"),E={en:{wind:"Wind speed",speed:"m/s",humidity:"Humidity",error:"Error! City not found"},ru:{wind:"Скорость ветра",speed:"м/с",humidity:"Влажность",error:"Ошибка! Город не найден"}};async function C(e,t){if(t.length>0){const n=`https://api.openweathermap.org/data/2.5/weather?q=${t}&lang=${e}&appid=11895977528da4edaa14e4c52f319385&units=metric`,i=await fetch(n),o=await i.json();w.classList="weather-icon owf",o.main?(w.classList.add(`owf-${o.weather[0].id}`),f.textContent=`${o.main.temp.toFixed(0)}°C`,k.textContent=o.weather[0].description,S.textContent=`${E[e].wind}: ${o.wind.speed.toFixed(0)}${E[e].speed}`,q.textContent=`${E[e].humidity}: ${o.main.humidity.toFixed(0)}%`,b.textContent=""):(b.textContent=`${E[e].error}`,f.textContent="",k.textContent="",S.textContent="",q.textContent="")}}function x(e){"Minsk"!==L.value&&"Минск"!==L.value||(L.value="en"===e?"Minsk":"Минск")}function _(e){L.placeholder="en"===e?"Enter city":"Введите город"}window.addEventListener("load",(()=>{let t=e("city");L.value=void 0!==t?t:"Minsk"})),window.addEventListener("beforeunload",(()=>{t("city",L.value)})),L.addEventListener("keypress",(function(t){"Enter"===t.code&&(C(e("lang"),L.value),L.blur())}));const D=document.querySelector("body"),$=document.querySelector(".input-tag "),I=document.querySelector("#flickr"),j=document.querySelector("#unsplash"),M=document.querySelector("#github"),K=document.querySelector(".slide-prev"),F=document.querySelector(".slide-next");let T,G=M.value,Z="";function H(e){"flickr"==G?async function(e){if(""===e){const e="https://www.flickr.com/services/rest/?method=flickr.galleries.getList&api_key=4c4a51dbb793ff8975aeae24ac88591c&user_id=197741851@N03&format=json&nojsoncallback=1",t=await fetch(e),i=`https://www.flickr.com/services/rest/?method=flickr.galleries.getPhotos&api_key=4c4a51dbb793ff8975aeae24ac88591c&gallery_id=${(await t.json()).galleries.gallery.find((e=>e.title._content===d())).gallery_id}&extras=url_h&format=json&nojsoncallback=1`,o=await fetch(i),c=await o.json(),s=new Image,a=n(0,19);s.src=c.photos.photo[a].url_h,s.onload=()=>{D.style.backgroundImage=`url('${s.src}')`}}else{const t=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=4c4a51dbb793ff8975aeae24ac88591c&tags=${e}&sort=relevance&per_page=500&extras=url_h&format=json&nojsoncallback=1`,i=await fetch(t),o=await i.json(),c=new Image,s=n(0,19);c.src=o.photos.photo[s].url_h,c.onload=()=>{D.style.backgroundImage=`url('${c.src}')`}}}(e):"unsplash"==G?async function(e){if(""===e){const e="https://api.unsplash.com/users/aspirituss/collections?client_id=_w4uNDZKDscnmCE98EC6LHb-RM_FgIznkv_vZKdJgKs",t=await fetch(e),i=`https://api.unsplash.com/collections/${(await t.json()).find((e=>e.title===d())).id}/photos?client_id=_w4uNDZKDscnmCE98EC6LHb-RM_FgIznkv_vZKdJgKs&per_page=20`,o=await fetch(i),c=await o.json(),s=new Image,a=n(0,19);s.src=c[a].urls.regular,s.onload=()=>{D.style.backgroundImage=`url('${s.src}')`}}else{const t=`https://api.unsplash.com/photos/random?orientation=landscape&query=${e}&client_id=_w4uNDZKDscnmCE98EC6LHb-RM_FgIznkv_vZKdJgKs`,n=await fetch(t),i=await n.json(),o=new Image;o.src=i.urls.regular,o.onload=()=>{D.style.backgroundImage=`url('${o.src}')`}}}(e):function(){const e=d(),t=T.toString().padStart(2,"0"),n=new Image;n.src=`https://raw.githubusercontent.com/svetlanalashuk/stage1-tasks/assets/images/${e}/${t}.jpg`,n.onload=()=>{D.style.backgroundImage=`url('${n.src}')`}}()}window.addEventListener("load",(()=>{T=n(1,20)})),M.addEventListener("change",(e=>{G=e.target.value,$.style.visibility="hidden",H(Z)})),I.addEventListener("change",(e=>{G=e.target.value,$.style.visibility="visible",H(Z)})),j.addEventListener("change",(e=>{G=e.target.value,$.style.visibility="visible",H(Z)})),K.addEventListener("click",(function(){T>1?T-=1:T=20,H(Z)})),F.addEventListener("click",(function(){T<20?T+=1:T=1,H(Z)})),$.addEventListener("keypress",(function(e){"Enter"===e.code&&(Z=$.value,H(Z),$.blur())}));const R=document.querySelector(".settings__button"),W=document.querySelector(".settings__info"),A=document.querySelector(".settings__lang-title"),N=document.querySelector(".en-button"),P=document.querySelector(".ru-button"),z=document.querySelector(".settings__pic-source"),J=document.querySelector(".input-tag"),Q=document.querySelector(".settings__checkboxes-title"),U=document.querySelector("#time"),Y=document.querySelector("#date"),B=document.querySelector("#greeting"),O=document.querySelector("#quote"),V=document.querySelector("#weather"),X=document.querySelector("#audio-player"),ee=document.querySelector(".checkbox-time-title"),te=document.querySelector(".checkbox-date-title"),ne=document.querySelector(".checkbox-greeting-title"),ie=document.querySelector(".checkbox-quote-title"),oe=document.querySelector(".checkbox-weather-title"),ce=document.querySelector(".checkbox-player-title"),se=document.querySelector(".greeting-container"),ae=document.querySelector(".quote-container"),re=document.querySelector(".weather"),le=document.querySelector(".player");let de;function ue(e){"en"===e?(A.textContent="Language",z.textContent="Image source",J.placeholder="Search by tag",Q.textContent="Hide/show blocks",ee.textContent="Time",te.textContent="Date",ne.textContent="Greeting",ie.textContent="Quote",oe.textContent="Weather",ce.textContent="Player"):(A.textContent="Язык",z.textContent="Источник изображений",J.placeholder="Поиск по тэгу",Q.textContent="Спрятать/показать блоки",ee.textContent="Время",te.textContent="Дата",ne.textContent="Приветствие",ie.textContent="Цитата",oe.textContent="Погода",ce.textContent="Плеер")}U.addEventListener("change",(()=>{t("isDisplayedTime",U.checked),U.checked?i.style.visibility="visible":i.style.visibility="hidden"})),Y.addEventListener("change",(()=>{t("isDisplayedDate",Y.checked),Y.checked?o.style.visibility="visible":o.style.visibility="hidden"})),B.addEventListener("change",(()=>{t("isDisplayedGreeting",B.checked),B.checked?se.style.visibility="visible":se.style.visibility="hidden"})),O.addEventListener("change",(()=>{t("isDisplayedQuote",O.checked),O.checked?ae.style.visibility="visible":ae.style.visibility="hidden"})),V.addEventListener("change",(()=>{t("isDisplayedWeather",V.checked),V.checked?re.style.visibility="visible":re.style.visibility="hidden"})),X.addEventListener("change",(()=>{t("isDisplayedPlayer",X.checked),X.checked?le.style.visibility="visible":le.style.visibility="hidden"})),R.addEventListener("click",(()=>{W.classList.toggle("active"),W.classList.contains("active")?M.checked?J.style.visibility="hidden":J.style.visibility="visible":J.style.visibility="hidden"})),N.addEventListener("click",(()=>{de="en",P.classList.remove("active"),N.classList.add("active"),t("lang",de),C(de,L.value),l(de),u(de),y(de),x(de),_(de),p(de,v),ue(de)})),P.addEventListener("click",(()=>{de="ru",N.classList.remove("active"),P.classList.add("active"),t("lang",de),C(de,L.value),l(de),u(de),y(de),x(de),_(de),p(de,v),ue(de)}));const ye=[{title:"River Flows In You",src:"./assets/sounds/River Flows In You.mp3",duration:"1:37"},{title:"Aqua Caelestic",src:"./assets/sounds/Aqua Caelestis.mp3",duration:"0:39"},{title:"Summer Wind",src:"./assets/sounds/Summer Wind.mp3",duration:"1:50"},{title:"Ennio Morricone",src:"./assets/sounds/Ennio Morricone.mp3",duration:"1:37"}];let me;const he=new Event("change"),ge=document.querySelector(".play-list"),ve=document.querySelector(".play"),pe=document.querySelector(".play-prev"),we=document.querySelector(".play-next");let fe=!1,ke=0;const be=new Audio;be.src=ye[ke].src,window.addEventListener("load",(()=>{function n(){c(),be.play(),fe=!0,ve.classList.add("pause")}function i(){ke=++ke%ye.length,be.src=ye[ke].src,be.currentTime=0,fe&&n()}me=e("lang"),void 0===me&&(t("lang","en"),me="en"),"en"===me?N.classList.add("active"):P.classList.add("active"),C(me,L.value),r(me),p(me),H(""),U.checked="true"===(e("isDisplayedTime")?.toLowerCase()??"true"),Y.checked="true"===(e("isDisplayedDate")?.toLowerCase()??"true"),B.checked="true"===(e("isDisplayedGreeting")?.toLowerCase()??"true"),O.checked="true"===(e("isDisplayedQuote")?.toLowerCase()??"true"),V.checked="true"===(e("isDisplayedWeather")?.toLowerCase()??"true"),X.checked="true"===(e("isDisplayedPlayer")?.toLowerCase()??"true"),U.dispatchEvent(he),Y.dispatchEvent(he),B.dispatchEvent(he),O.dispatchEvent(he),V.dispatchEvent(he),X.dispatchEvent(he),ye.forEach((e=>{const t=document.createElement("li");t.classList.add("play-item"),t.textContent=e.title,ge.append(t)})),ve.addEventListener("click",(()=>{fe?(be.pause(),fe=!1,ve.classList.remove("pause")):n()})),pe.addEventListener("click",(()=>{ke>0?ke-=1:ke=ye.length-1,be.src=ye[ke].src,be.currentTime=0,fe&&n()})),we.addEventListener("click",(()=>{i()})),be.addEventListener("ended",(()=>{i()}));const o=document.querySelectorAll(".play-item");o.forEach(((e,t)=>{e.addEventListener("click",(()=>{ke=t,c(),be.src=ye[ke].src,n()}))}));const c=()=>{o.forEach((e=>e.classList.remove("item-active"))),o[ke].classList.add("item-active")}}))})();